import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
from matplotlib.colors import ListedColormap

def readd(fid):
    with open(fid,'rb') as f:
        bdata = f.read()
    fdata = np.frombuffer(bdata, dtype='f')
    if bdata[0:4] == b'ndnd':
        ncol = int(bdata[4:8])
        nrow = int(bdata[8:12])
        fdata = np.reshape(fdata,[nrow+1,ncol])
        fdata = fdata[1:,:]
    else:
        k = int(np.sqrt(np.size(fdata)))
        fdata = np.reshape(fdata,[k, k])
    return fdata

def ndread(fid):
    with open(fid,'rb') as f:
        bdata = f.read()
    fdata = np.frombuffer(bdata, dtype='f')
    if bdata[0:4] == b'ndnd':
        ncol = int(bdata[4:8])
        nrow = int(bdata[8:12])
        fdata = np.reshape(fdata,[nrow+1,ncol])
        fdata = fdata[1:,:]
    else:
        k = int(np.sqrt(np.size(fdata)))
        fdata = np.reshape(fdata,[k, k])
        ncol = k
        nrow = k
    return fdata, nrow, ncol

def ndwrite(inp,fid):
    inp = np.array(inp, dtype='f')
    nrow,ncol = np.shape(inp)
    bdata = bytes(inp)
    with open(fid,'wb') as f:
        if ncol!=nrow:
            f.write(b'ndnd')
            f.write(str(ncol).zfill(4).encode())
            f.write(str(nrow).zfill(4).encode())
            f.write(bytes(np.zeros((ncol-3,),dtype='i4')))
        f.write(bdata)


def npndwrite(inp,fid):
#    inp = np.array(inp, dtype='f')
    nrow,ncol = np.shape(inp)
    bdata = bytes(inp)
    with open(fid,'wb') as f:
        if ncol!=nrow:
            f.write(b'ndnd')
            f.write(str(ncol).zfill(4).encode())
            f.write(str(nrow).zfill(4).encode())
            f.write(bytes(np.zeros((ncol-3,),dtype='i4')))
        f.write(bdata)


def myplotimage(array,fignumber,title):

    mycolors=mycolormap()
    mymap = ListedColormap(mycolors)

    plt.style.use("dark_background")

    fig1 = plt.figure(fignumber,figsize = (12,27/4))

    params = {"text.color" : "grey",
    "xtick.color" : "grey",
    "ytick.color" : "grey",
    "axes.edgecolor" : "black"}

    plt.rcParams.update(params)

    dmax = np.amax(array)
    dmin = np.amin(array)

    norm = mpl.colors.Normalize(vmin=-dmax,vmax=dmax)

    #print(dmax)

    plt.imshow(array, origin='lower',cmap=mymap, norm = norm)

    plt.colorbar()

    ny, nx = np.shape(array)

    firstline  = bytes.decode(str(ny).encode()) + ' x ' + bytes.decode(str(nx).encode()) + '     '+title + '\n \n'

    #secondline =  bytes.decode(str(ny).encode()) + ' x ' + bytes.decode(str(nx).encode()) + '\n\n'

    thirdline =  'Max = '  + bytes.decode(str(dmax).encode()) + '      Min = '  + bytes.decode(str(dmin).encode())

    longtitle = firstline + thirdline + '\n'

    plt.title(longtitle, color="yellow")
    plt.draw()
    plt.pause(0.1)

def mycolormap():
    mycolors = [ [ 0.78,    1.00,  1.00 ],
    [ 0.78,    1.00,    1.00  ],
    [ 0.78,    1.00,    1.00  ],
    [ 0.73,    1.00,    1.00  ],
    [ 0.73,    1.00,    1.00  ],
    [ 0.68,    1.00,    1.00  ],
    [ 0.68,    1.00,    1.00  ],
    [ 0.64,    1.00,    1.00  ],
    [ 0.64,    1.00,    1.00  ],
    [ 0.59,    1.00,    1.00  ],
    [ 0.59,    1.00,    1.00  ],
    [ 0.54,    1.00,    1.00  ],
    [ 0.54,    1.00,    1.00  ],
    [ 0.50,    1.00,    1.00  ],
    [ 0.50,    1.00,    1.00  ],
    [ 0.45,    1.00,    1.00  ],
    [ 0.45,    1.00,    1.00  ],
    [ 0.40,    1.00,    1.00  ],
    [ 0.40,    1.00,    1.00  ],
    [ 0.36,    1.00,    1.00  ],
    [ 0.36,    1.00,    1.00  ],
    [ 0.31,    1.00,    1.00  ],
    [ 0.31,    1.00,    1.00  ],
    [ 0.26,    1.00,    1.00  ],
    [ 0.26,    1.00,    1.00  ],
    [ 0.21,    1.00,    1.00  ],
    [ 0.21,    1.00,    1.00  ],
    [ 0.17,    1.00,    1.00  ],
    [ 0.17,    1.00,    1.00  ],
    [ 0.12,    1.00,    1.00  ],
    [ 0.12,    1.00,    1.00  ],
    [ 0.07,    1.00,    1.00  ],
    [ 0.07,    1.00,    1.00  ],
    [ 0.03,    1.00,    1.00  ],
    [ 0.03,    1.00,    1.00  ],
    [ 0.00,    0.98,    1.00  ],
    [ 0.00,    0.98,    1.00  ],
    [ 0.00,    0.95,    1.00  ],
    [ 0.00,    0.95,    1.00  ],
    [ 0.00,    0.92,    1.00  ],
    [ 0.00,    0.92,    1.00  ],
    [ 0.00,    0.89,    1.00  ],
    [ 0.00,    0.89,    1.00  ],
    [ 0.00,    0.86,    1.00  ],
    [ 0.00,    0.86,    1.00  ],
    [ 0.00,    0.82,    1.00  ],
    [ 0.00,    0.82,    1.00  ],
    [ 0.00,    0.79,    1.00  ],
    [ 0.00,    0.79,    1.00  ],
    [ 0.00,    0.76,    1.00  ],
    [ 0.00,    0.76,    1.00  ],
    [ 0.00,    0.71,    1.00  ],
    [ 0.00,    0.71,    1.00  ],
    [ 0.00,    0.70,    1.00  ],
    [ 0.00,    0.70,    1.00  ],
    [ 0.00,    0.67,    1.00  ],
    [ 0.00,    0.67,    1.00  ],
    [ 0.00,    0.62,    1.00  ],
    [ 0.00,    0.62,    1.00  ],
    [ 0.00,    0.61,    1.00  ],
    [ 0.00,    0.61,    1.00  ],
    [ 0.00,    0.57,    1.00  ],
    [ 0.00,    0.57,    1.00  ],
    [ 0.00,    0.54,    1.00  ],
    [ 0.00,    0.54,    1.00  ],
    [ 0.00,    0.51,    1.00  ],
    [ 0.00,    0.51,    1.00  ],
    [ 0.00,    0.46,    1.00  ],
    [ 0.00,    0.46,    1.00  ],
    [ 0.00,    0.45,    1.00  ],
    [ 0.00,    0.45,    1.00  ],
    [ 0.00,    0.42,    1.00  ],
    [ 0.00,    0.42,    1.00  ],
    [ 0.00,    0.39,    1.00  ],
    [ 0.00,    0.39,    1.00  ],
    [ 0.00,    0.36,    1.00  ],
    [ 0.00,    0.36,    1.00  ],
    [ 0.00,    0.32,    1.00  ],
    [ 0.00,    0.32,    1.00  ],
    [ 0.00,    0.28,    1.00  ],
    [ 0.00,    0.28,    1.00  ],
    [ 0.00,    0.26,    1.00  ],
    [ 0.00,    0.26,    1.00  ],
    [ 0.00,    0.23,    1.00  ],
    [ 0.00,    0.23,    1.00  ],
    [ 0.00,    0.23,    1.00  ],
    [ 0.00,    0.23,    1.00  ],
    [ 0.00,    0.23,    0.95  ],
    [ 0.00,    0.23,    0.95  ],
    [ 0.00,    0.23,    0.92  ],
    [ 0.00,    0.23,    0.92  ],
    [ 0.00,    0.23,    0.89  ],
    [ 0.00,    0.23,    0.89  ],
    [ 0.00,    0.23,    0.86  ],
    [ 0.00,    0.23,    0.86  ],
    [ 0.00,    0.23,    0.81  ],
    [ 0.00,    0.23,    0.81  ],
    [ 0.00,    0.23,    0.78  ],
    [ 0.00,    0.23,    0.78  ],
    [ 0.00,    0.23,    0.75  ],
    [ 0.00,    0.23,    0.75  ],
    [ 0.00,    0.23,    0.71  ],
    [ 0.00,    0.23,    0.71  ],
    [ 0.04,    0.23,    0.67  ],
    [ 0.04,    0.23,    0.67  ],
    [ 0.09,    0.23,    0.64  ],
    [ 0.09,    0.23,    0.64  ],
    [ 0.14,    0.23,    0.61  ],
    [ 0.14,    0.23,    0.61  ],
    [ 0.18,    0.23,    0.57  ],
    [ 0.18,    0.23,    0.57  ],
    [ 0.23,    0.23,    0.54  ],
    [ 0.23,    0.23,    0.54  ],
    [ 0.23,    0.23,    0.50  ],
    [ 0.23,    0.23,    0.50  ],
    [ 0.23,    0.23,    0.46  ],
    [ 0.23,    0.23,    0.46  ],
    [ 0.23,    0.23,    0.43  ],
    [ 0.23,    0.23,    0.43  ],
    [ 0.23,    0.23,    0.40  ],
    [ 0.23,    0.23,    0.40  ],
    [ 0.23,    0.23,    0.36  ],
    [ 0.23,    0.23,    0.36  ],
    [ 0.23,    0.23,    0.32  ],
    [ 0.23,    0.23,    0.32  ],
    [ 0.23,    0.23,    0.29  ],
    [ 0.23,    0.23,    0.29  ],
    [ 0.23,    0.23,    0.26  ],
    [ 0.23,    0.23,    0.26  ],
    [ 0.23,    0.23,    0.23  ],
    [ 0.23,    0.23,    0.23  ],
    [ 0.26,    0.23,    0.23  ],
    [ 0.26,    0.23,    0.23  ],
    [ 0.29,    0.23,    0.23  ],
    [ 0.29,    0.23,    0.23  ],
    [ 0.32,    0.23,    0.23  ],
    [ 0.32,    0.23,    0.23  ],
    [ 0.36,    0.23,    0.23  ],
    [ 0.36,    0.23,    0.23  ],
    [ 0.40,    0.23,    0.23  ],
    [ 0.40,    0.23,    0.23  ],
    [ 0.43,    0.23,    0.23  ],
    [ 0.43,    0.23,    0.23  ],
    [ 0.46,    0.23,    0.23  ],
    [ 0.46,    0.23,    0.23  ],
    [ 0.50,    0.23,    0.23  ],
    [ 0.50,    0.23,    0.23  ],
    [ 0.54,    0.23,    0.23  ],
    [ 0.54,    0.23,    0.23  ],
    [ 0.57,    0.23,    0.18  ],
    [ 0.57,    0.23,    0.18  ],
    [ 0.61,    0.23,    0.14  ],
    [ 0.61,    0.23,    0.14  ],
    [ 0.64,    0.23,    0.09  ],
    [ 0.64,    0.23,    0.09  ],
    [ 0.67,    0.23,    0.04  ],
    [ 0.67,    0.23,    0.04  ],
    [ 0.71,    0.23,    0.00  ],
    [ 0.71,    0.23,    0.00  ],
    [ 0.75,    0.23,    0.00  ],
    [ 0.75,    0.23,    0.00  ],
    [ 0.78,    0.23,    0.00  ],
    [ 0.78,    0.23,    0.00  ],
    [ 0.81,    0.23,    0.00  ],
    [ 0.81,    0.23,    0.00  ],
    [ 0.86,    0.23,    0.00  ],
    [ 0.86,    0.23,    0.00  ],
    [ 0.89,    0.23,    0.00  ],
    [ 0.89,    0.23,    0.00  ],
    [ 0.92,    0.23,    0.00  ],
    [ 0.92,    0.23,    0.00  ],
    [ 0.95,    0.23,    0.00  ],
    [ 0.95,    0.23,    0.00  ],
    [ 1.00,    0.23,    0.00  ],
    [ 1.00,    0.23,    0.00  ],
    [ 1.00,    0.23,    0.00  ],
    [ 1.00,    0.23,    0.00  ],
    [ 1.00,    0.26,    0.00  ],
    [ 1.00,    0.26,    0.00  ],
    [ 1.00,    0.29,    0.00  ],
    [ 1.00,    0.29,    0.00  ],
    [ 1.00,    0.32,    0.00  ],
    [ 1.00,    0.32,    0.00  ],
    [ 1.00,    0.36,    0.00  ],
    [ 1.00,    0.36,    0.00  ],
    [ 1.00,    0.39,    0.00  ],
    [ 1.00,    0.39,    0.00  ],
    [ 1.00,    0.42,    0.00  ],
    [ 1.00,    0.42,    0.00  ],
    [ 1.00,    0.45,    0.00  ],
    [ 1.00,    0.45,    0.00  ],
    [ 1.00,    0.48,    0.00  ],
    [ 1.00,    0.48,    0.00  ],
    [ 1.00,    0.51,    0.00  ],
    [ 1.00,    0.51,    0.00  ],
    [ 1.00,    0.54,    0.00  ],
    [ 1.00,    0.54,    0.00  ],
    [ 1.00,    0.57,    0.00  ],
    [ 1.00,    0.57,    0.00  ],
    [ 1.00,    0.61,    0.00  ],
    [ 1.00,    0.61,    0.00  ],
    [ 1.00,    0.64,    0.00  ],
    [ 1.00,    0.64,    0.00  ],
    [ 1.00,    0.67,    0.00  ],
    [ 1.00,    0.67,    0.00  ],
    [ 1.00,    0.70,    0.00  ],
    [ 1.00,    0.70,    0.00  ],
    [ 1.00,    0.73,    0.00  ],
    [ 1.00,    0.73,    0.00  ],
    [ 1.00,    0.76,    0.00  ],
    [ 1.00,    0.76,    0.00  ],
    [ 1.00,    0.79,    0.00  ],
    [ 1.00,    0.79,    0.00  ],
    [ 1.00,    0.82,    0.00  ],
    [ 1.00,    0.82,    0.00  ],
    [ 1.00,    0.86,    0.00  ],
    [ 1.00,    0.86,    0.00  ],
    [ 1.00,    0.89,    0.00  ],
    [ 1.00,    0.89,    0.00  ],
    [ 1.00,    0.92,    0.00  ],
    [ 1.00,    0.92,    0.00  ],
    [ 1.00,    0.95,    0.00  ],
    [ 1.00,    0.95,    0.00  ],
    [ 1.00,    1.00,    0.00  ],
    [ 1.00,    1.00,    0.00  ],
    [ 1.00,    1.00,    0.03  ],
    [ 1.00,    1.00,    0.03  ],
    [ 1.00,    1.00,    0.07  ],
    [ 1.00,    1.00,    0.07  ],
    [ 1.00,    1.00,    0.12  ],
    [ 1.00,    1.00,    0.12  ],
    [ 1.00,    1.00,    0.17  ],
    [ 1.00,    1.00,    0.17  ],
    [ 1.00,    1.00,    0.21  ],
    [ 1.00,    1.00,    0.21  ],
    [ 1.00,    1.00,    0.26  ],
    [ 1.00,    1.00,    0.26  ],
    [ 1.00,    1.00,    0.31  ],
    [ 1.00,    1.00,    0.31  ],
    [ 1.00,    1.00,    0.36  ],
    [ 1.00,    1.00,    0.36  ],
    [ 1.00,    1.00,    0.40  ],
    [ 1.00,    1.00,    0.40  ],
    [ 1.00,    1.00,    0.45  ],
    [ 1.00,    1.00,    0.45  ],
    [ 1.00,    1.00,    0.50  ],
    [ 1.00,    1.00,    0.50  ],
    [ 1.00,    1.00,    0.54  ],
    [ 1.00,    1.00,    0.54  ],
    [ 1.00,    1.00,    0.59  ],
    [ 1.00,    1.00,    0.59  ],
    [ 1.00,    1.00,    0.64  ],
    [ 1.00,    1.00,    0.64  ],
    [ 1.00,    1.00,    0.68  ],
    [ 1.00,    1.00,    0.68  ],
    [ 1.00,    1.00,    0.73  ] ]
    return mycolors
















